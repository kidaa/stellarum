<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>CATALOGUS STELLARUM</title>

    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/jquery-ui-1.10.3.custom.js"></script>
    <script src="js/purl.js"></script>
    <script src="js/stars.js"></script>
    <script src="js/starmap.js"></script>

    <link type="text/css" rel="stylesheet" href="css/starmap-theme/jquery-ui-1.10.3.custom.css" />
    <link type="text/css" rel="stylesheet" href="css/starmap.css" />
  </head>

  <body>

    <div id="starmap">
    </div>

    <div id="text" class="start">

      <input id="starname"
             type="text"
             class="start"
             value="SEARCH" />
      
      <div id="stardesignation"></div>
      <div id="coords"></div>
      <div id="description">

        <p>Welcome to the CATALOGUS STELLARUM, an index of local
        concentrations of BRIGHT MATTER.</p>

        <p>Search for stars by name in the , select them from the
        celestial sphere, or press the LEFT and RIGHT arrows to step
        through in alphabetical order.</p>
      </div>

    <div id="aboutctrl">ABOUT</div>
      
    <div id="about">
      <p>Written and coded by <a target="_blank" href="http://twitter.com/spikelynch">Mike Lynch</a>. The CATALOGUS was originally posted on my Twitter
            account <a target="_blank" href="http://twitter.com/FSVO">FSVO</a> in
            2012. If you like this sort of parascientific nonsense, get on board.</p>
          
      <p>This web visualisation is in beta.  It hasn't been
            well-tested and will need a modern browser.  If you have
         any bug reports or suggestions, you can get in touch with me
         at <a href="mailto:spike.lynch@gmail.com">spike.lynch@gmail.com</a>.</p>
      <p>The scripts used to generate the visualisation are on <a href="https://github.com/spikelynch/stellarum">Github</a>.</p>
    
      <p>The main sources for star names and data were
            Wikipedia, <i>Star Names: Their Lore and Meaning</i> by
            Richard Hinckley Allen,
            and <a target="_blank" href="http://stars.astro.illinois.edu/">Prof. Jim
            Kaler's Star of the Week website.</a></p>

          <p>Star colour values from Mitchell
      Charity's <a target="_blank" href="http://www.vendian.org/mncharity/dir3/starcolor/">star
      colour reference page.</a></p>
      
          <p>Built with Michael Bostock's
      visualisation library <a target="_blank" href="http://d3js.org">D3.js</a> and the <a target="_blank" href="http://jqueryui.com/">jQuery UI</a>
      toolkit.</p>

          <p>Collating the tweets into JSON was made easy
      by  <a target="_blank" href="https://pinboard.in/">Pinboard,</a> the Internet's
      finest bookmarking and web archive service.</p></p>


          
          <div class="hideabout">[x]</div>
      </div>



    </div>
      


    <script lang="javascript">

      var starNames = [];

      for (var i = 0; i < stars.length; i++ ) {
          starNames.push({ label: stars[i].name, value: stars[i].id });
      }

      function star_autocomplete(event) {
          $(this).val("");
          $(this).off("focus", star_autocomplete);
          $(this).autocomplete({
              delay: 0,
              source: starNames,
              focus: function(e, ui) {
                  $('#starname').val(ui.item.label);
                  return false;
              },
              select: function(e, ui) {
                  $('#starname').val(ui.item.label);
                  var id = ui.item.value;
                  var star = stars[id];
                  if( star ) {
                     $(this).blur();
                     select_star(star, SPIN_TIME);
                  }
                  return false;
              },
          });

      }

      var url = $.url();
      var star = url.param('star');
      render_map("div#starmap", 800, 800, star);

      $("input#starname").on("focus", star_autocomplete);

      $(document).on("keypress", function(e) {
          if( e.which == 32 ) {
              if( $("input#starname").is(":focus") ) {
                  return 1;
              } else {
                  if ( current_star ) {
                      var id = current_star.id;
                      var nid = parseInt(id) + 1;
                      if( stars[nid] ) {
                          select_star(stars[nid], SPIN_TIME);
                      } else {
                          select_star(stars[0], SPIN_TIME);
                      }
                  } else {
                      select_star(stars[0], SPIN_TIME);
                  }
              } 
        }
    });



                          
      $("div#aboutctrl").on("click", function(e) {
           if( $("div#about").is(':hidden') ) { 
                 $("div#about").show();
           } else {
                 $("div#about").hide();
           }
      });

      $("div.hideabout").on("click", function(e) {
           $("div#about").hide();
      });


    </script>


  </body>
</html>
